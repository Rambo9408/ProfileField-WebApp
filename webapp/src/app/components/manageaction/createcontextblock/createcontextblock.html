<div class="context-dialog-wrapper">
    <div class="hedder-content">
        <h2 mat-dialog-title><strong>Context Block</strong></h2>
        <button mat-icon-button (click)="dialogRef.close()" aria-label="Close">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div mat-dialog-content class="form-container">

        <!-- Toolbar -->
        <!-- <div class="editor-toolbar">
            <button type="button" class="toolbar-button" (click)="formatText('bold')">B</button>
            <button type="button" class="toolbar-button" (click)="formatText('italic')">I</button>
            <button type="button" class="toolbar-button" (click)="formatText('underline')">U</button>
            <button type="button" class="toolbar-button" (click)="formatText('insertUnorderedList')">â€¢</button>
            <button type="button" class="toolbar-button" (click)="formatText('insertOrderedList')">â‰¡</button>
            <button type="button" class="toolbar-button" (click)="formatText('createLink')">ðŸ”—</button>
        </div> -->

        <!-- Contenteditable div instead of textarea -->
        <!-- <div class="editor-content" contenteditable="true" #editor placeholder="Type your content here..."></div> -->

        <!-- <ckeditor [(ngModel)]="contentBlockInfo" [config]="editorConfig" name="contentBlockInfo"></ckeditor> -->
        <!-- <div class="ckeditor-container">
             <ckeditor [editor]="Editor" [(ngModel)]="contentBlockInfo" [config]="editorConfig"
                 (ready)="onReady($event)"
                 style="min-height: 300px; display: block; border: 1px solid #ccc;">
             </ckeditor>
         </div> -->

        <div class="ckeditor-container">
            <quill-editor [(ngModel)]="contentBlockInfo" [modules]="quillModules" theme="snow" style="height: 300px;"
                placeholder="Type your content here">
            </quill-editor>
        </div>

        <!-- Attachment checkbox -->
        <mat-checkbox class="checkbox" [(ngModel)]="showAttachedFileOptions">
            Include up to 10 attachments at the bottom of this Context Block.
        </mat-checkbox>
        @if(showAttachedFileOptions){
        <div class="file-attachement-box">
            <p>Please name this file:</p>

            @for (attachment of attachments; track $index) {
            <div class="attachment-item">
                <div class="input-form-fileds">
                    <!-- <mat-form-field appearance="fill" class="full-width">
                        <input matInput class="inputClass" [(ngModel)]="attachment.fileName" placeholder="Enter The File Name">
                    </mat-form-field> -->
                    <input class="inputClass" [(ngModel)]="attachment.fileName" placeholder="Enter The File Name">

                    @if(attachment.originalFileName){
                    <label class="file-attachment-link">{{ attachment.originalFileName }}</label>
                    <a class="deleteLink" (click)="removeAttachment($index)">
                        <img src="delete_large.png" height="17">
                    </a>
                    }
                    @else {
                    <span class="file-attachment-link" (click)="fileInput.click()">Attach File Here</span>
                    <input type="file" #fileInput style="display:none" (change)="onFileSelected($event, $index)"
                        accept="image/*" />
                    }
                </div>
            </div>
            }
        </div>
        }

        <!-- Add to Panel dropdown -->
        <div class="dropdown-section">
            <label class="dropdown-label"><span class="required">*</span> Add to Panel:</label>
            <mat-form-field appearance="fill" class="full-width">
                <mat-select [(ngModel)]="selectedPanel" name="selectedPanel"
                    (selectionChange)="onPanelChange($event.value, '')" required>
                    <mat-option value="">Select One</mat-option>
                    @for (panel of panels; track panel._id) {
                    <mat-option [value]="panel._id">{{ panel.panelName }}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
        </div>

        @if (subPanels.length > 0) {
        <div class="dropdown-section">
            <label class="dropdown-label"><span class="required">*</span> Add to Sub-panel:</label>
            <mat-form-field appearance="fill" class="full-width">
                <mat-select [(ngModel)]="selectedSubPanel" name="selectedSubPanel">
                    <mat-option value="">Select One</mat-option>
                    @for (subPanel of subPanels; track subPanel._id) {
                    <mat-option [value]="subPanel._id">{{ subPanel.subPanelName }}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
        </div>
        }

        <!-- Volunteers checkbox -->
        <div class="checkbox-section">
            <label class="checkbox-label">Volunteers Profile Access:</label>
            <mat-checkbox [(ngModel)]="volunteerAccess" name="volunteerAccess">
                Allow volunteers to see this context block.
            </mat-checkbox>
        </div>

        <!-- Buttons -->
        <div class="btn-group">
            <button mat-raised-button color="primary" (click)="onCreate()">
                {{ isEditMode ? 'Update' : 'Create' }}
            </button>
            <button mat-button (click)="onCancel()">Cancel</button>
        </div>
    </div>
</div>